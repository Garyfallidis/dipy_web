{"parents": [{"link": "../../documentation/", "title": "Documentation"}, {"link": "../", "title": "Theory and concepts"}], "prev": {"link": "../spherical/", "title": "Spherical coordinates"}, "next": {"link": "../../reference/", "title": "API Reference"}, "title": "Spherical Harmonic bases", "meta": {}, "body": "<div class=\"section\" id=\"spherical-harmonic-bases\">\n<span id=\"sh-basis\"></span><h1>Spherical Harmonic bases<a class=\"headerlink\" href=\"#spherical-harmonic-bases\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>Spherical Harmonics (SH) are functions defined on the sphere. A collection of SH\ncan used as a basis function to represent and reconstruct any function on the\nsurface of a unit sphere.</p>\n<p>Spherical harmonics are ortho-normal functions defined by:</p>\n<div class=\"math notranslate nohighlight\">\n\\[Y_l^m(\\theta, \\phi) = (-1)^m \\sqrt{\\frac{2l + 1}{4 \\pi} \\frac{(l - m)!}{(l + m)!}} P_l^m( cos \\theta) e^{i m \\phi}\\]</div>\n<p>where <span class=\"math notranslate nohighlight\">\\(l\\)</span> is the band index, <span class=\"math notranslate nohighlight\">\\(m\\)</span> is the order, <span class=\"math notranslate nohighlight\">\\(P_l^m\\)</span> is an associated\n<span class=\"math notranslate nohighlight\">\\(l\\)</span>-th degree, <span class=\"math notranslate nohighlight\">\\(m\\)</span>-th order Legendre polynomial, and <span class=\"math notranslate nohighlight\">\\((\\theta, \\phi)\\)</span> is the\nrepresentation of the direction vector in the spherical coordinate.</p>\n<p>A function <span class=\"math notranslate nohighlight\">\\(f(\\theta, \\phi)\\)</span> can be represented using a spherical harmonics\nbasis using the spherical harmonics coefficients <span class=\"math notranslate nohighlight\">\\(a_l^m\\)</span>, which can be\ncomputed using the expression:</p>\n<div class=\"math notranslate nohighlight\">\n\\[a_l^m = \\int_S f(\\theta, \\phi) Y_l^m(\\theta, \\phi) ds\\]</div>\n<p>Once the coefficients are computed, the function <span class=\"math notranslate nohighlight\">\\(f(\\theta, \\phi)\\)</span> can be\napproximately computed as:</p>\n<div class=\"math notranslate nohighlight\">\n\\[f(\\theta, \\phi) = \\sum_{l = 0}^{\\inf} \\sum_{m = -l}^{l} a^m_l Y_l^m(\\theta, \\phi)\\]</div>\n<p>In HARDI, the Orientation Distribution Function (ODF) is a function on the\nsphere.</p>\n<p>Several Spherical Harmonics bases have been proposed in the diffusion imaging\nliterature for the computation of the ODF. DIPY implements two of these in the\n<a class=\"reference internal\" href=\"../../reference/dipy.reconst/#module-dipy.reconst.shm\" title=\"dipy.reconst.shm\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">shm</span></code></a> module tool set:</p>\n<ul class=\"simple\">\n<li>The basis proposed by Descoteaux <em>et al.</em> <a class=\"footnote-reference\" href=\"#id5\" id=\"id1\">[1]</a>:</li>\n</ul>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\sqrt{2} \\Re(Y_l^m(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\sqrt{2} \\Im(Y_l^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<ul class=\"simple\">\n<li>The basis proposed by Tournier <em>et al.</em> <a class=\"footnote-reference\" href=\"#id6\" id=\"id2\">[2]</a>:</li>\n</ul>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\Re(Y_l^m(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_k^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\Im(Y_{|l|}^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<p>In both cases, <span class=\"math notranslate nohighlight\">\\(\\Re\\)</span> denotes the real part of the spherical harmonic basis, and\n<span class=\"math notranslate nohighlight\">\\(\\Im\\)</span> denotes the imaginary part.</p>\n<p>In practice, a maximum even order <span class=\"math notranslate nohighlight\">\\(k\\)</span> is chosen such that <span class=\"math notranslate nohighlight\">\\(k \\leq l\\)</span>. The\nchoice of an even order is motivated by the symmetry of the diffusion process\naround the origin.</p>\n<p>Descoteaux <em>et al.</em> <a class=\"footnote-reference\" href=\"#id5\" id=\"id3\">[1]</a> use the Q-Ball Imaging (QBI) formalization to recover\nthe ODF, while Tournier <em>et al.</em> <a class=\"footnote-reference\" href=\"#id6\" id=\"id4\">[2]</a> use the Spherical Deconvolution (SD)\nframework to recover the ODF.</p>\n<div class=\"section\" id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<table class=\"docutils footnote\" frame=\"void\" id=\"id5\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[1]</td><td><em>(<a class=\"fn-backref\" href=\"#id1\">1</a>, <a class=\"fn-backref\" href=\"#id3\">2</a>)</em> Descoteaux, M., Angelino, E., Fitzgibbons, S. and Deriche, R.\nRegularized, Fast, and Robust Analytical Q\u2010ball Imaging.\nMagn. Reson. Med. 2007;58:497-510.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils footnote\" frame=\"void\" id=\"id6\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[2]</td><td><em>(<a class=\"fn-backref\" href=\"#id2\">1</a>, <a class=\"fn-backref\" href=\"#id4\">2</a>)</em> Tournier J.D., Calamante F. and Connelly A. Robust determination\nof the fibre orientation distribution in diffusion MRI:\nNon-negativity constrained super-resolved spherical deconvolution.\nNeuroImage. 2007;35(4):1459\u20131472.</td></tr>\n</tbody>\n</table>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["reference/index", "API Reference", "N", "next"], ["theory/spherical", "Spherical coordinates", "P", "previous"]], "sourcename": "theory/sh_basis.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Spherical Harmonic bases</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "theory/sh_basis", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.11"}