{"parents": [], "prev": null, "next": null, "title": "Reconstruction of the diffusion signal with the kurtosis tensor model", "meta": {}, "body": "<div class=\"section\" id=\"reconstruction-of-the-diffusion-signal-with-the-kurtosis-tensor-model\">\n<span id=\"example-reconst-dki\"></span><h1>Reconstruction of the diffusion signal with the kurtosis tensor model<a class=\"headerlink\" href=\"#reconstruction-of-the-diffusion-signal-with-the-kurtosis-tensor-model\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p>The diffusion kurtosis model is an expansion of the diffusion tensor model\n(see <a class=\"reference internal\" href=\"../reconst_dti/#example-reconst-dti\"><span class=\"std std-ref\">Reconstruction of the diffusion signal with the Tensor model</span></a>). In addition to the diffusion tensor (DT), the\ndiffusion kurtosis model quantifies the degree to which water diffusion in\nbiological tissues is non-Gaussian using the kurtosis tensor (KT)\n<a class=\"reference internal\" href=\"#jensen2005\" id=\"id1\">[Jensen2005]</a>.</p>\n<p>Measurements of non-Gaussian diffusion from the diffusion kurtosis model are of\ninterest because they can be used to charaterize tissue microstructural\nheterogeneity <a class=\"reference internal\" href=\"#jensen2010\" id=\"id2\">[Jensen2010]</a> and to derive concrete biophysical parameters, such\nas the density of axonal fibres and diffusion tortuosity <a class=\"reference internal\" href=\"#fieremans2011\" id=\"id3\">[Fieremans2011]</a>.\nMoreover, DKI can be used to resolve crossing fibers in tractography and to\nobtain invariant rotational measures not limited to well-aligned fiber\npopulations <a class=\"reference internal\" href=\"#netohe2015\" id=\"id4\">[NetoHe2015]</a>.</p>\n<p>The diffusion kurtosis model expresses the diffusion-weighted signal as:</p>\n<div class=\"math notranslate nohighlight\">\n\\[S(n,b)=S_{0}e^{-bD(n)+\\frac{1}{6}b^{2}D(n)^{2}K(n)}\\]</div>\n<p>where <span class=\"math notranslate nohighlight\">\\(\\mathbf{b}\\)</span> is the applied diffusion weighting (which is dependent on\nthe measurement parameters), <span class=\"math notranslate nohighlight\">\\(S_0\\)</span> is the signal in the absence of diffusion\ngradient sensitization, <span class=\"math notranslate nohighlight\">\\(\\mathbf{D(n)}\\)</span> is the value of diffusion along\ndirection <span class=\"math notranslate nohighlight\">\\(\\mathbf{n}\\)</span>, and <span class=\"math notranslate nohighlight\">\\(\\mathbf{K(n)}\\)</span> is the value of kurtosis along\ndirection <span class=\"math notranslate nohighlight\">\\(\\mathbf{n}\\)</span>. The directional diffusion <span class=\"math notranslate nohighlight\">\\(\\mathbf{D(n)}\\)</span> and kurtosis\n<span class=\"math notranslate nohighlight\">\\(\\mathbf{K(n)}\\)</span> can be related to the diffusion tensor (DT) and kurtosis tensor\n(KT) using the following equations:</p>\n<div class=\"math notranslate nohighlight\">\n\\[D(n)=\\sum_{i=1}^{3}\\sum_{j=1}^{3}n_{i}n_{j}D_{ij}\\]</div>\n<p>and</p>\n<div class=\"math notranslate nohighlight\">\n\\[K(n)=\\frac{MD^{2}}{D(n)^{2}}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\sum_{k=1}^{3}\n\\sum_{l=1}^{3}n_{i}n_{j}n_{k}n_{l}W_{ijkl}\\]</div>\n<p>where <span class=\"math notranslate nohighlight\">\\(D_{ij}\\)</span> are the elements of the second-order DT, and <span class=\"math notranslate nohighlight\">\\(W_{ijkl}\\)</span> the\nelements of the fourth-order KT and <span class=\"math notranslate nohighlight\">\\(MD\\)</span> is the mean diffusivity. As the DT,\nKT has antipodal symmetry and thus only 15 Wijkl elemments are needed to fully\ncharacterize the KT:</p>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}\\begin{matrix} ( &amp; W_{xxxx} &amp; W_{yyyy} &amp; W_{zzzz} &amp; W_{xxxy} &amp; W_{xxxz}\n                 &amp; ... \\\\\n                 &amp; W_{xyyy} &amp; W_{yyyz} &amp; W_{xzzz} &amp; W_{yzzz} &amp; W_{xxyy}\n                 &amp; ... \\\\\n                 &amp; W_{xxzz} &amp; W_{yyzz} &amp; W_{xxyz} &amp; W_{xyyz} &amp; W_{xyzz}\n                 &amp; &amp; )\\end{matrix}\\end{split}\\]</div>\n<p>In the following example we show how to fit the diffusion kurtosis model on\ndiffusion-weighted multi-shell datasets and how to estimate diffusion kurtosis\nbased statistics.</p>\n<p>First, we import all relevant modules:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"nn\">plt</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.dki</span> <span class=\"k\">as</span> <span class=\"nn\">dki</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.dti</span> <span class=\"k\">as</span> <span class=\"nn\">dti</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.dki_micro</span> <span class=\"k\">as</span> <span class=\"nn\">dki_micro</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">fetch_cfin_multib</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">read_cfin_dwi</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.segment.mask</span> <span class=\"k\">import</span> <span class=\"n\">median_otsu</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.ndimage.filters</span> <span class=\"k\">import</span> <span class=\"n\">gaussian_filter</span>\n</pre></div>\n</div>\n<p>DKI requires multi-shell data, i.e. data acquired from more than one non-zero\nb-value. Here, we use fetch to download a multi-shell dataset which was kindly\nprovided by Hansen and Jespersen (more details about the data are provided in\ntheir paper <a class=\"reference internal\" href=\"#hansen2016\" id=\"id5\">[Hansen2016]</a>). The total size of the downloaded data is 192\nMBytes, however you only need to fetch it once.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fetch_cfin_multib</span><span class=\"p\">()</span>\n\n<span class=\"n\">img</span><span class=\"p\">,</span> <span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">read_cfin_dwi</span><span class=\"p\">()</span>\n\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">img</span><span class=\"o\">.</span><span class=\"n\">get_data</span><span class=\"p\">()</span>\n\n<span class=\"n\">affine</span> <span class=\"o\">=</span> <span class=\"n\">img</span><span class=\"o\">.</span><span class=\"n\">affine</span>\n</pre></div>\n</div>\n<p>Function <code class=\"docutils literal notranslate\"><span class=\"pre\">read_cenir_multib</span></code> return img and gtab which contains respectively\na nibabel Nifti1Image object (where the data can be extracted) and a\nGradientTable object with information about the b-values and b-vectors.</p>\n<p>Before fitting the data, we preform some data pre-processing. We first compute\na brain mask to avoid unnecessary calculations on the background of the image.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">maskdata</span><span class=\"p\">,</span> <span class=\"n\">mask</span> <span class=\"o\">=</span> <span class=\"n\">median_otsu</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">vol_idx</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">dilate</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Since the diffusion kurtosis models involves the estimation of a large number\nof parameters <a class=\"reference internal\" href=\"#taxcmw2015\" id=\"id6\">[TaxCMW2015]</a> and since the non-Gaussian components of the\ndiffusion signal are more sensitive to artefacts <a class=\"reference internal\" href=\"#netohe2012\" id=\"id7\">[NetoHe2012]</a>, it might be\nfavorable to suppress the effects of noise and artefacts before diffusion\nkurtosis fitting. In this example the effects of noise and artefacts are\nsuppress by using 3D Gaussian smoothing (with a Gaussian kernel with\nfwhm=1.25) as suggested by pioneer DKI studies (e.g. <a class=\"reference internal\" href=\"#jensen2005\" id=\"id8\">[Jensen2005]</a>,\n<a class=\"reference internal\" href=\"#netohe2012\" id=\"id9\">[NetoHe2012]</a>). Although here the Gaussian smoothing is used so that results\nare comparable to these studies, it is important to note that more advanced\nnoise and artifact suppression algorithms are available in <a class=\"reference external\" href=\"http://dipy.org\">DIPY</a> (e.g. the\nnon-local means filter <span class=\"xref std std-ref\">example-denoise-nlmeans</span>).</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fwhm</span> <span class=\"o\">=</span> <span class=\"mf\">1.25</span>\n<span class=\"n\">gauss_std</span> <span class=\"o\">=</span> <span class=\"n\">fwhm</span> <span class=\"o\">/</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sqrt</span><span class=\"p\">(</span><span class=\"mi\">8</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">))</span>  <span class=\"c1\"># converting fwhm to Gaussian std</span>\n<span class=\"n\">data_smooth</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">v</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]):</span>\n    <span class=\"n\">data_smooth</span><span class=\"p\">[</span><span class=\"o\">...</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">gaussian_filter</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"o\">...</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">],</span> <span class=\"n\">sigma</span><span class=\"o\">=</span><span class=\"n\">gauss_std</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Now that we have loaded and pre-processed the data we can go forward\nwith DKI fitting. For this, the DKI model is first defined for the data\u2019s\nGradientTable object by instantiating the DiffusionKurtosisModel object in the\nfollowing way:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dkimodel</span> <span class=\"o\">=</span> <span class=\"n\">dki</span><span class=\"o\">.</span><span class=\"n\">DiffusionKurtosisModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>To fit the data using the defined model object, we call the <code class=\"docutils literal notranslate\"><span class=\"pre\">fit</span></code> function of\nthis object:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dkifit</span> <span class=\"o\">=</span> <span class=\"n\">dkimodel</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_smooth</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>The fit method creates a DiffusionKurtosisFit object, which contains all the\ndiffusion and kurtosis fitting parameters and other DKI attributes. For\ninstance, since the diffusion kurtosis model estimates the diffusion tensor,\nall diffusion standard tensor statistics can be computed from the\nDiffusionKurtosisFit instance. For example, we show below how to extract the\nfractional anisotropy (FA), the mean diffusivity (MD), the axial diffusivity\n(AD) and the radial diffusivity (RD) from the DiffusionKurtosisiFit instance.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">FA</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">fa</span>\n<span class=\"n\">MD</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">md</span>\n<span class=\"n\">AD</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">ad</span>\n<span class=\"n\">RD</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">rd</span>\n</pre></div>\n</div>\n<p>Note that these four standard measures could also be computed from DIPY\u2019s DTI\nmodule. Theoretically, computing these measures from both models should be\nanalogous. However, according to recent studies, the diffusion statistics from\nthe kurtosis model are expected to have better accuracy <a class=\"reference internal\" href=\"#veraar2011\" id=\"id10\">[Veraar2011]</a>,\n<a class=\"reference internal\" href=\"#netohe2012\" id=\"id11\">[NetoHe2012]</a>. For comparison purposes, we calculate below the FA, MD, AD, and\nRD using DIPY\u2019s <code class=\"docutils literal notranslate\"><span class=\"pre\">TensorModel</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">tenmodel</span> <span class=\"o\">=</span> <span class=\"n\">dti</span><span class=\"o\">.</span><span class=\"n\">TensorModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">)</span>\n<span class=\"n\">tenfit</span> <span class=\"o\">=</span> <span class=\"n\">tenmodel</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_smooth</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n\n<span class=\"n\">dti_FA</span> <span class=\"o\">=</span> <span class=\"n\">tenfit</span><span class=\"o\">.</span><span class=\"n\">fa</span>\n<span class=\"n\">dti_MD</span> <span class=\"o\">=</span> <span class=\"n\">tenfit</span><span class=\"o\">.</span><span class=\"n\">md</span>\n<span class=\"n\">dti_AD</span> <span class=\"o\">=</span> <span class=\"n\">tenfit</span><span class=\"o\">.</span><span class=\"n\">ad</span>\n<span class=\"n\">dti_RD</span> <span class=\"o\">=</span> <span class=\"n\">tenfit</span><span class=\"o\">.</span><span class=\"n\">rd</span>\n</pre></div>\n</div>\n<p>The DT based measures can be easily visualized using matplotlib. For example,\nthe FA, MD, AD, and RD obtained from the diffusion kurtosis model (upper\npanels) and the tensor model (lower panels) are plotted for a selected axial\nslice.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">axial_slice</span> <span class=\"o\">=</span> <span class=\"mi\">9</span>\n\n<span class=\"n\">fig1</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">),</span>\n                        <span class=\"n\">subplot_kw</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;xticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;yticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]})</span>\n\n<span class=\"n\">fig1</span><span class=\"o\">.</span><span class=\"n\">subplots_adjust</span><span class=\"p\">(</span><span class=\"n\">hspace</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">wspace</span><span class=\"o\">=</span><span class=\"mf\">0.05</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">FA</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;FA (DKI)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MD</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">2.0e-3</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MD (DKI)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">AD</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">2.0e-3</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;AD (DKI)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">RD</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">2.0e-3</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;RD (DKI)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">dti_FA</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;FA (DTI)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">dti_MD</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">2.0e-3</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MD (DTI)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">dti_AD</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">2.0e-3</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;AD (DTI)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">dti_RD</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">2.0e-3</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;RD (DTI)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n<span class=\"n\">fig1</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;Diffusion_tensor_measures_from_DTI_and_DKI.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"figure align-center\" id=\"id17\">\n<img alt=\"../../_images/Diffusion_tensor_measures_from_DTI_and_DKI.png\" src=\"../../_images/Diffusion_tensor_measures_from_DTI_and_DKI.png\" />\n<p class=\"caption\"><span class=\"caption-text\">Diffusion tensor measures obtained from the diffusion tensor estimated\nfrom DKI (upper panels) and DTI (lower panels).</span></p>\n</div>\n<p>In addition to the standard diffusion statistics, the DiffusionKurtosisFit\ninstance can be used to estimate the non-Gaussian measures of mean kurtosis\n(MK), the axial kurtosis (AK) and the radial kurtosis (RK).</p>\n<p>Kurtosis measures are susceptible to high amplitude outliers. The impact of\nhigh amplitude kurtosis outliers can be removed by introducing as an optional\ninput the extremes of the typical values of kurtosis. Here these are assumed to\nbe on the range between 0 and 3):</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">MK</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">mk</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"n\">AK</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">ak</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"n\">RK</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">rk</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Now we are ready to plot the kurtosis standard measures using matplotlib:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fig2</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">),</span>\n                        <span class=\"n\">subplot_kw</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;xticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;yticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]})</span>\n\n<span class=\"n\">fig2</span><span class=\"o\">.</span><span class=\"n\">subplots_adjust</span><span class=\"p\">(</span><span class=\"n\">hspace</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">wspace</span><span class=\"o\">=</span><span class=\"mf\">0.05</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MK</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">1.5</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MK&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">AK</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">1.5</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;AK&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">RK</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">1.5</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;RK&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n<span class=\"n\">fig2</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;Kurtosis_tensor_standard_measures.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"figure align-center\" id=\"id18\">\n<img alt=\"../../_images/Kurtosis_tensor_standard_measures.png\" src=\"../../_images/Kurtosis_tensor_standard_measures.png\" />\n<p class=\"caption\"><span class=\"caption-text\">Kurtosis tensor standard measures obtained from the kurtosis tensor.</span></p>\n</div>\n<p>The non-Gaussian behaviour of the diffusion signal is larger when water\ndiffusion is restricted by compartments and barriers (e.g., myelin sheath).\nTherefore, as the figure above shows, white matter kurtosis values are smaller\nalong the axial direction of fibers (smaller amplitudes shown in the AK map)\nthan for the radial directions (larger amplitudes shown in the RK map).</p>\n<p>As mentioned above, DKI can also be used to derive concrete biophysical\nparameters by applying microstructural models to DT and KT estimated from DKI.\nFor instance,  Fieremans et al. <a class=\"reference internal\" href=\"#fieremans2011\" id=\"id12\">[Fieremans2011]</a> showed that DKI can be used to\nestimate the contribution of hindered and restricted diffusion for well-aligned\nfibers. These tensors can be also interpreted as the influences of intra- and\nextra-cellular compartments and can be used to estimate the axonal volume\nfraction and diffusion extra-cellular tortuosity. According to recent studies,\nthese latter measures can be used to distinguish processes of axonal loss from\nprocesses of myelin degeneration <a class=\"reference internal\" href=\"#fieremans2012\" id=\"id13\">[Fieremans2012]</a>.</p>\n<p>The model proposed by Fieremans and colleagues can be defined in DIPY by\ninstantiating the \u2018KurtosisMicrostructureModel\u2019 object in the following way:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dki_micro_model</span> <span class=\"o\">=</span> <span class=\"n\">dki_micro</span><span class=\"o\">.</span><span class=\"n\">KurtosisMicrostructureModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Before fitting this microstructural model, it is useful to indicate the\nregions in which this model provides meaningful information (i.e. voxels of\nwell-aligned fibers). Following Fieremans et al. <a class=\"reference internal\" href=\"#fieremans2011\" id=\"id14\">[Fieremans2011]</a>, a simple way\nto select this region is to generate a well-aligned fiber mask based on the\nvalues of diffusion sphericity, planarity and linearity. Here we will follow\nthese selection criteria for a better comparision of our figures with the\noriginal article published by Fieremans et al. <a class=\"reference internal\" href=\"#fieremans2011\" id=\"id15\">[Fieremans2011]</a>. Nevertheless,\nit is important to note that voxels with well-aligned fibers can be selected\nbased on other approaches such as using predefined regions of interest.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">well_aligned_mask</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[:</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"s1\">&#39;bool&#39;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Diffusion coefficient of linearity (cl) has to be larger than 0.4, thus</span>\n<span class=\"c1\"># we exclude voxels with cl &lt; 0.4.</span>\n<span class=\"n\">cl</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">linearity</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n<span class=\"n\">well_aligned_mask</span><span class=\"p\">[</span><span class=\"n\">cl</span> <span class=\"o\">&lt;</span> <span class=\"mf\">0.4</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n<span class=\"c1\"># Diffusion coefficient of planarity (cp) has to be lower than 0.2, thus</span>\n<span class=\"c1\"># we exclude voxels with cp &gt; 0.2.</span>\n<span class=\"n\">cp</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">planarity</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n<span class=\"n\">well_aligned_mask</span><span class=\"p\">[</span><span class=\"n\">cp</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.2</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n<span class=\"c1\"># Diffusion coefficient of sphericity (cs) has to be lower than 0.35, thus</span>\n<span class=\"c1\"># we exclude voxels with cs &gt; 0.35.</span>\n<span class=\"n\">cs</span> <span class=\"o\">=</span> <span class=\"n\">dkifit</span><span class=\"o\">.</span><span class=\"n\">sphericity</span><span class=\"o\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n<span class=\"n\">well_aligned_mask</span><span class=\"p\">[</span><span class=\"n\">cs</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.35</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n<span class=\"c1\"># Removing nan associated with background voxels</span>\n<span class=\"n\">well_aligned_mask</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">cl</span><span class=\"p\">)]</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n<span class=\"n\">well_aligned_mask</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">cp</span><span class=\"p\">)]</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n<span class=\"n\">well_aligned_mask</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">cs</span><span class=\"p\">)]</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n</pre></div>\n</div>\n<p>Analogous to DKI, the data fit can be done by calling the <code class=\"docutils literal notranslate\"><span class=\"pre\">fit</span></code> function of\nthe model\u2019s object as follows:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dki_micro_fit</span> <span class=\"o\">=</span> <span class=\"n\">dki_micro_model</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_smooth</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">well_aligned_mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>The KurtosisMicrostructureFit object created by this <code class=\"docutils literal notranslate\"><span class=\"pre\">fit</span></code> function can then\nbe used to extract model parameters such as the axonal water fraction and\ndiffusion hindered tortuosity:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">AWF</span> <span class=\"o\">=</span> <span class=\"n\">dki_micro_fit</span><span class=\"o\">.</span><span class=\"n\">awf</span>\n<span class=\"n\">TORT</span> <span class=\"o\">=</span> <span class=\"n\">dki_micro_fit</span><span class=\"o\">.</span><span class=\"n\">tortuosity</span>\n</pre></div>\n</div>\n<p>These parameters are plotted below on top of the mean kurtosis maps:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fig3</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">),</span>\n                        <span class=\"n\">subplot_kw</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;xticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;yticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]})</span>\n\n<span class=\"n\">AWF</span><span class=\"p\">[</span><span class=\"n\">AWF</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan</span>\n<span class=\"n\">TORT</span><span class=\"p\">[</span><span class=\"n\">TORT</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nan</span>\n\n<span class=\"n\">ax</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MK</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">cm</span><span class=\"o\">.</span><span class=\"n\">gray</span><span class=\"p\">,</span> <span class=\"n\">interpolation</span><span class=\"o\">=</span><span class=\"s1\">&#39;nearest&#39;</span><span class=\"p\">,</span>\n             <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">im0</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">AWF</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">cm</span><span class=\"o\">.</span><span class=\"n\">Reds</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.9</span><span class=\"p\">,</span>\n                   <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mf\">0.3</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span> <span class=\"n\">interpolation</span><span class=\"o\">=</span><span class=\"s1\">&#39;nearest&#39;</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">fig3</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">(</span><span class=\"n\">im0</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n\n<span class=\"n\">ax</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MK</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">cm</span><span class=\"o\">.</span><span class=\"n\">gray</span><span class=\"p\">,</span> <span class=\"n\">interpolation</span><span class=\"o\">=</span><span class=\"s1\">&#39;nearest&#39;</span><span class=\"p\">,</span>\n             <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">im1</span> <span class=\"o\">=</span> <span class=\"n\">ax</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">TORT</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">cm</span><span class=\"o\">.</span><span class=\"n\">Blues</span><span class=\"p\">,</span> <span class=\"n\">alpha</span><span class=\"o\">=</span><span class=\"mf\">0.9</span><span class=\"p\">,</span>\n                   <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"n\">interpolation</span><span class=\"o\">=</span><span class=\"s1\">&#39;nearest&#39;</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">fig3</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">(</span><span class=\"n\">im1</span><span class=\"p\">,</span> <span class=\"n\">ax</span><span class=\"o\">=</span><span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"n\">fig3</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;Kurtosis_Microstructural_measures.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"figure align-center\" id=\"id19\">\n<img alt=\"../../_images/Kurtosis_Microstructural_measures.png\" src=\"../../_images/Kurtosis_Microstructural_measures.png\" />\n<p class=\"caption\"><span class=\"caption-text\">Axonal water fraction (left panel) and tortuosity (right panel) values\nof well-aligned fiber regions overlaid on a top of a mean kurtosis all-brain\nimage.</span></p>\n</div>\n<div class=\"section\" id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<table class=\"docutils citation\" frame=\"void\" id=\"taxcmw2015\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id6\">[TaxCMW2015]</a></td><td>Tax CMW, Otte WM, Viergever MA, Dijkhuizen RM, Leemans A\n(2014). REKINDLE: Robust extraction of kurtosis INDices with\nlinear estimation. Magnetic Resonance in Medicine 73(2):\n794-808.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"jensen2005\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[Jensen2005]</td><td><em>(<a class=\"fn-backref\" href=\"#id1\">1</a>, <a class=\"fn-backref\" href=\"#id8\">2</a>)</em> Jensen JH, Helpern JA, Ramani A, Lu H, Kaczynski K (2005).\nDiffusional Kurtosis Imaging: The Quantification of\nNon_Gaussian Water Diffusion by Means of Magnetic Resonance\nImaging. Magnetic Resonance in Medicine 53: 1432-1440</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"jensen2010\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id2\">[Jensen2010]</a></td><td>Jensen JH, Helpern JA (2010). MRI quantification of\nnon-Gaussian water diffusion by kurtosis analysis. NMR in\nBiomedicine 23(7): 698-710</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"fieremans2011\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[Fieremans2011]</td><td><em>(<a class=\"fn-backref\" href=\"#id3\">1</a>, <a class=\"fn-backref\" href=\"#id12\">2</a>, <a class=\"fn-backref\" href=\"#id14\">3</a>, <a class=\"fn-backref\" href=\"#id15\">4</a>)</em> Fieremans E, Jensen JH, Helpern JA (2011). White matter\ncharacterization with diffusion kurtosis imaging. NeuroImage\n58: 177-188</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"fieremans2012\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id13\">[Fieremans2012]</a></td><td>Fieremans E, Jensen JH, Helpern JA, Kim S, Grossman RI,\nInglese M, Novikov DS. (2012). Diffusion distinguishes between\naxonal loss and demyelination in brain white matter.\nProceedings of the 20th Annual Meeting of the International\nSociety for Magnetic Resonance Medicine; Melbourne, Australia.\nMay 5-11.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"hansen2016\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id5\">[Hansen2016]</a></td><td>Hansen, B, Jespersen, SN (2016). Data for evaluation of fast\nkurtosis strategies, b-value optimization and exploration of\ndiffusion MRI contrast. Scientific Data 3: 160072\ndoi:10.1038/sdata.2016.72</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"netohe2012\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[NetoHe2012]</td><td><em>(<a class=\"fn-backref\" href=\"#id7\">1</a>, <a class=\"fn-backref\" href=\"#id9\">2</a>, <a class=\"fn-backref\" href=\"#id11\">3</a>)</em> Neto Henriques R, Ferreira H, Correia M, (2012). Diffusion\nkurtosis imaging of the healthy human brain. Master\nDissertation Bachelor and Master Programin Biomedical\nEngineering and Biophysics, Faculty of Sciences.\n<a class=\"reference external\" href=\"http://repositorio.ul.pt/bitstream/10451/8511/1/ulfc104137_tm_Rafael_Henriques.pdf\">http://repositorio.ul.pt/bitstream/10451/8511/1/ulfc104137_tm_Rafael_Henriques.pdf</a></td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"netohe2015\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id4\">[NetoHe2015]</a></td><td>Neto Henriques R, Correia MM, Nunes RG, Ferreira HA (2015).\nExploring the 3D geometry of the diffusion kurtosis tensor -\nImpact on the development of robust tractography procedures and\nnovel biomarkers, NeuroImage 111: 85-99</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"veraar2011\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id10\">[Veraar2011]</a></td><td>Veraart J, Poot DH, Van Hecke W, Blockx I, Van der Linden A,\nVerhoye M, Sijbers J (2011). More Accurate Estimation of\nDiffusion Tensor Parameters Using Diffusion Kurtosis Imaging.\nMagnetic Resonance in Medicine 65(1): 138-145</td></tr>\n</tbody>\n</table>\n<div class=\"admonition-example-source-code admonition\">\n<p class=\"first admonition-title\">Example source code</p>\n<p class=\"last\">You can download <a class=\"reference download internal\" href=\"../../_downloads/reconst_dki.py\" download=\"\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">the</span> <span class=\"pre\">full</span> <span class=\"pre\">source</span> <span class=\"pre\">code</span> <span class=\"pre\">of</span> <span class=\"pre\">this</span> <span class=\"pre\">example</span></code></a>.\nThis same script is also included in the dipy source distribution under the\n<code class=\"file docutils literal notranslate\"><span class=\"pre\">doc/examples/</span></code> directory.</p>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"]], "sourcename": "examples_built/reconst_dki.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Reconstruction of the diffusion signal with the kurtosis tensor model</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/reconst_dki", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.11"}